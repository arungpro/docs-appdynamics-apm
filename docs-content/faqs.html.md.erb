---
title: Appdynamics Pivotal Cloud Foundry Tile FAQs
owner: Partners
---

## <a id='GeneralFAQs'></a> General FAQs

### <a id='g1'></a> <a id='g1'></a> What is included in the AppDynamics Tile?

* AppDynamics Service Broker - for application instrumentation
* AppDynamics Machine Agent - for collecting PCF metrics through a custom nozzle from Loggregator
* AppDynamics PCF Dashboard - an autogenerated custom dashboard that creates healthrules for the above PCF metrics and neatly presents it
* AppDynamics Analytics - for transaction analytics

### <a id='g2'></a> <a id='g1'></a> I am only interested in APM. Should I configure Machine Agent and Transaction Analytics?

*  For now, provide dummy values in the tile forms. We are working with Pivotal to release a lighter APM-only product soon.

### <a id='g3'></a> How do I configure SSL (On-Prem Controller deployment)?

Ensure you have included the entire certificate chain in the security config of the OpsManager director tile. This will ensure that all BOSH deployments and Diego cells can access those certificates automatically while doing SSL validation.

AppDynamics deployments automatically reads the certificates and imports them into correct keystores. No additional steps are needed. Follow the exact format, excluding comments, as specified in the Pivotal OpsManager documentation. Ensure you check the all SSL check boxes in Tile Configuration Forms.

### <a id='g4'></a> How do I configure SSL (SAAS deployment)?

AppDynamics SAAS Controllers are signed with standard DigiCerts CA. They are already included in the BOSH deployments and application containers.

Make sure that you check the all SSL checkboxes in Tile Configuration Forms.

### <a id='g5'></a> My installation failed. What do I provide to AppDynamics Support?

Collect the error logs from the OpsManager installation page and provide the entire deployment log.


## <a id='SBFAQS'></a> AppDynamics Service Broker and Buildpacks - APM FAQs

### <a id='s1'></a> What is AppDynamics Service Broker?

AppDynamics Service Broker implements [Service Broker API](https://github.com/openservicebrokerapi/servicebroker) and provides [a credential service](https://docs.pivotal.io/pivotalcf/2-2/services/overview.html) for applications to bind. When bound, the necessary AppDynamics configuration is automatically imported into the applications environment for buildpacks to read and configure AppDynamics agents.

### <a id='s2'></a> Can I bind to AppDynamics without the Service Broker and still instrument applications? (CUPS)

Yes. You can bind a user-provided service by creating a user-provided service.

1. Run the following command: `cf cups SERVICE-NAME  -p '{"account-access-key":"ACCESS-KEY", "account-name":"ACCOUNT", "application-name":"APP", "host-name":"HOST", "plan-description": "PLAN", "plan-name": "NAME", "port":"PORT", "ssl-enabled":TRUE | FALSE}'`

1. Edit the values and execute the above command. This creates a user-provided service.

1. Bind the application to the user-provided service and restage.

### <a id='s3'></a> What language buildpacks have AppDynamics support included?

The following buildpacks are supported. The [AppDynamics documentation for Pivotal](https://docs.appdynamics.com/display/PCF) includes several step-by-step example workflows with sample applications.

    |  Language | Buildpack  | Sample Workflow | Sample Aplication|
    |---|---|---|---|
    | Java  |  https://github.com/cloudfoundry/java-buildpack | [Java Application Workflow](https://docs.appdynamics.com/display/PCF/Java+Application+in+PCF+-+Monitoring+Workflow) | https://github.com/Appdynamics/cloudfoundry-apps/tree/master/cf-java-sample |
    | PHP  | https://github.com/cloudfoundry/php-buildpack  | [PHP Application workflow](https://docs.appdynamics.com/display/PCF/PHP+Application+in+PCF+-+Monitoring+Workflow) | |
    |  Python |  https://github.com/cloudfoundry/python-buildpack#develop | [Python Application Workflow](https://docs.appdynamics.com/display/PCF/Python+Application+in+PCF+-+Monitoring+Workflow) | https://github.com/Appdynamics/cloudfoundry-apps/tree/master/cf-python |
    |  NodeJS |  https://github.com/cloudfoundry/nodejs-buildpack|   [Node JS Application Workflow](https://docs.appdynamics.com/display/PCF/Python+Application+in+PCF+-+Monitoring+Workflow)| https://github.com/Appdynamics/cloudfoundry-apps/tree/master/cf-nodejs |
    | GoLang  | https://github.com/cloudfoundry/go-buildpack  | | |
    |  .NET |  https://github.com/cloudfoundry/nodejs-buildpack|   [.NET Application Workflow](https://github.com/Appdynamics/cloudfoundry-apps/tree/master/cf-NET-sample)| https://github.com/Appdynamics/cloudfoundry-apps/tree/master/cf-NET-sample|

### <a id='s4'></a> I have a deployment with no Internet access. How do I push the applications?

You can use the Java Buildpack shipped with CF environments directly, using any Java Buildback version released after November 2017. In addition, you must place the AppDynamics agent downloaded from the [AppDynamics index.yml file](packages.appdynamics.com/java/index.yml) using the procedure in the [Offline Package](https://github.com/cloudfoundry/java-buildpack#offline-package) section of _Cloud Foundry Java Buildpack_.

### <a id='s5'></a> How do I customize the AppName, TierName, and NodeName?

AppDynamics Buildpacks autogenerates AppNames TierNames, and NodeNames by looking into the deployed environment. You can customize this autogeneration by setting the configuration environment variables.

Override the following environment by running `cf set-env APP ENVNAME ENVVALUE`.

    |AGENT|	APPLICATION ENV VARIABLE|	TIER ENV VARIABLE|	NODE ENV VARIABLE|
    |---|---|---|---|
    |Python|	APPD_APP_NAME|	APPD_TIER_NAME|	APPD_NODE_NAME|
    |Java|	APPDYNAMICS_AGENT_APPLICATION_NAME|	APPDYNAMICS_AGENT_TIER_NAME|	APPDYNAMICS_AGENT_NODE_NAME|
    |NodeJS|	APPDYNAMICS_AGENT_APPLICATION_NAME|	APPDYNAMICS_AGENT_TIER_NAME| APPDYNAMICS_AGENT_NODE_NAME|
    |Golang|	APPD_APP_NAME|	APPD_TIER_NAME|	APPD_NODE_NAME|

### <a id='s6'></a> How do I configure the Java Buildpack to fetch a particular agent version?

By default, Buildpack fetches the latest available agent entry in the [index.yml](packages.appdynamics.com/java/index.yml) file. You can override the default behavior by setting [these variables](https://github.com/cloudfoundry/java-buildpack/blob/master/docs/framework-app_dynamics_agent.md#configuration).
  * To use a specific version, set the env JBP_CONFIG_APP_DYNAMICS_AGENT by running `cf set-env YOUR_APP_NAME JBP_CONFIG_APP_DYNAMICS_AGENT 'version: 4.4.111'`.
  * To use another package index, set the env JBP_CONFIG_APP_DYNAMICS_AGENT by running `cf set-env YOUR_APP_NAME JBP_CONFIG_APP_DYNAMICS_AGENT 'repository_root: "https://exmple.duckdns.org"' `

### <a id='s7'></a> Java buildpack is failing to fetch a particular agent version.

If you are using the default package index, verify that the version in question is present in the output of the following command: `curl -sSL https://packages.appdynamics.com/java/index.yml -H "user-agent: Ruby" -H "accept-encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3" -H "accept: */*"`

If it does not show up in the output, reach out to AppDynamics Support or the #java-buildpack channel of the Cloud Foundry Slack.

### <a id='s8'></a> My application push fails. What do I provide to AppDynamics Support?

* cf push logs
* Application manifest (if present)

### <a id='s9'></a>  My application is running, but I do not see any metrics on Controller. How do I troubleshoot?

Run `cf env application` and see if the `VCAP_SERVICES` environment variable has AppDynamics information.

* If not, bind the application to the AppDynamics service and restage.
* If yes, ensure all the credentials (Controller information, key, SSL) are correctly set. If you are using SSL, make sure that it is enabled ("ssl: true") in `VCAP_SERVICES`.

### <a id='s10'></a> What should I provide to AppDynamics Support?

* cf logs {appname}
* cf env {appname}
* cf ssh {appname}
  + Figure out the process ID of the running application by running `ps aux`.
  + cat /proc/{pid}/environ
  + Agent logs
    | AGENT  | LOGS  |
    | ------------ | ------------ |
    |  NODE.JS  | /tmp/appd/{hash} |
    | JAVA   |  {WIP} |
    |   Python |  {WIP} |
    |PHP| {WIP}|
    |GoLang| {WIP}|


## <a id='MA FAQS'></a> AppDynamics Machine Agent - Platform Metrics FAQs

### <a id='m1'></a> What does the AppDynamics Machine Agent collect?

The AppDynamics Machine Agent deployed through the tile collects various KPI metrics of PCF environment exposed through Loggregator.

### <a id='m2'></a> How is the AppDynamics Machine Agent deployed?

The Machine Agent deployed through the tile includes a PCF monitoring extension that creates a custom nozzle and collects all the exposed KPI metrics. It is a BOSH deployment in Ops Manager.

### <a id='m3'></a> How can I verify that the Machine Agent is properly deployed?

1. Once the tile is configured and installed properly, go to the application you have created to collect the metrics on the Controller.

1. Open the Metric browser and see `Application Infrastructure Performance -} {Tier-Name} -} Custom Metrics -} PCF Firehose Monitor` in the metric tree. If you find that folder, the Machine Agent is properly deployed. You can use the custom dashboard for a cleaner view or use the Metric Browser to look at the detailed metrics without any health rules.

### <a id='m4'></a> How do I access the AppDynamics Machine Agent deployment?

1. Log in to Ops Manager.

1. Find the AppDynamics deployment.

1. Log in to the AppDynamics deployment VM.
   * The Machine Agent root folder is in `/var/vcap/packages/appd_machine_agent_pkg`.
   * The Machine agent configuration and control scripts are in `cd /var/vcap/jobs/appd_machine_agent_job`.
  ```
    bash
    ubuntu@pie-20-ops-manager:~$ bosh -e gcp deployments | grep appdynamics
    appdynamics-50d1e026bc3e30178992            	appd_machine_agent/4.4.337           	bosh-google-kvm-ubuntu-trusty-go_agent/3586.16	-	latest
                                                  appdynamics/4.4.337

    ubuntu@pie-20-ops-manager:~$ bosh -e gcp -d appdynamics-50d1e026bc3e30178992 ssh
  ```

### <a id='m5'></a> Where are the logs for the AppDynamics Machine Agent?

The logs are in the root folder of the Machine Agent in the AppDynamics BOSH VM deployment, `/var/vcap/packages/appd_machine_agent_pkg/logs`.

### <a id='m6'></a> How do I stop the AppDynamics Machine Agent?

The processes in the BOSH deloyment are managed by `monit`. Enter the following command: `monit stop machineagent`

  ```
  bash
  machineagent_server_node/7fd4d170-a563-4828-bf19-063a4d1b6b34:~$ sudo su
  machineagent_server_node/7fd4d170-a563-4828-bf19-063a4d1b6b34:/var/vcap/bosh_ssh/bosh_f59d11e1eca346c# monit summary
    The Monit daemon 5.2.5 uptime: 4d 0h 17m

          Process 'machineagent'              running
          Process 'bosh-dns'                  running
          System 'system_localhost'           running
  machineagent_server_node/7fd4d170-a563-4828-bf19-063a4d1b6b34:/var/vcap/bosh_ssh/bosh_f59d11e1eca346c# monit stop machineagent
  ```

### <a id='m7'></a> How do I customize the Machine Agent configuration?

1. Edit `Controller-info.xml` in the folder `/var/vcap/jobs/appd_machine_agent_job/config`.

1. Restart the Machine Agent by running `monit restart machineagent`.

### <a id='m8'></a> How do I start AppDynamics Machine Agent?

Run the monit script by running the command `monit start machineagent`.

### <a id='m9'></a> There is an SSL issue connecting to the Controller. How do I troubleshoot it?

The Machine Agent uses three SSL certificates:

* `trusted_certs.pem` to talk to the Controller, which gets converted into `cacerts.jks`. Make sure your certificate chain is present in `trusted_certs.pem`.
* `ca_cert.pem` and `cert.pem`, which are auto-generated by Ops Manager and used by the nozzle.

### <a id='m10'></a> I am not getting any platform metrics. What should I double-check?

* Make sure that SSL is properly configured.
* Make sure that the application name, tier name and Tier-ID are properly configured.
* See the Machine Agent logs to check for errors.

### <a id='m11'></a> What should I provide AppDynamics Support?

* Contents of the conf directory: `ls -al /var/vcap/packages/appd_machine_agent_pkg/conf`
* Set the log level to debug by editing `ls -al /var/vcap/packages/appd_machine_agent_pkg/conf/logging/log4j.xml` and collect ten minutes' worth of debug logs.


## <a id='PCFDashboardFAQS'></a> AppDynamics PCF Dashboard FAQs

### <a id='d1'></a> What is PCF Dashboard?

The PCF Dashboard Generator is a Python 3 application that generates a platform dashboard and set of health rules for PCF foundations that have installed the Appd Tile v4.4.x. The generated dashboard and health rules leverage the custom metrics published by the AppDynamics Tile to the AppDynamics Controller and application configured in the tile.

### <a id='d2'></a> Where do I find this dashboard?

Navigate to **Controller UI > Dashboards and Reports page > `APPNAME-TIERNAME-PCF KPI Dashboard`**, where APPNAME and TIERNAME are the Machine Agent application name and tier name configured in the tile.

### <a id='d3'></a> How is this dashboard created?

The dashboard application reads the KPI metrics emitted by Machine Agent in the tile, associates them with various auto-generated Health Rules, and renders a neat custom dashboard.
<!--
### <a id='d4'></a> What is the required RBAC for the account used for dashboard configuration?
   * TODO -- update based on Jeff's screenshots
-->

### <a id='d5'></a> I don't see this dashboard. How do I troubleshoot?

Make sure the application is deployed properly. You should see `appdpcfdashboard-version` running.

```
      bash
      pavan.krishna@OSXLTPKrishna:~/appdy$ cf target -o appdynamics-org -s appdynamics-space
      pavan.krishna@OSXLTPKrishna:~/appdy$ cf apps
          Getting apps in org appdynamics-org / space appdynamics-space as admin...
      name                       requested state   instances   memory   disk   urls
      appdpcfdashboard-4.4.337   started           1/1         128M     1G      appdpcfdashboard.cfapps.pie-20.cfplatformeng.com
```

### <a id='d6'></a> Where do I find the logs?

Run `cf logs appdpcfdashboard-VERSION` in the org `appdynamics-org` and the space `appdynamics-space`.

### <a id='d7'></a> How do I troubleshoot an SSL issue?

1. Run `cf ssh  appdpcfdashboard-VERSION`.

1. Ensure the correct certificate is present in `/home/vcap/app/cert.pem` of the application by running `cat /home/vcap/app/cert.pem`.

### <a id='d8'></a> How do I change a configuration variable?

All configuration of the application is done with environment variables. To change a variable, run `cf set-env appdpcfdashboard-VERSION ENV-NAME ENV-VARIABLE`.

To list the variables, run `cf env appdpcfdashboard-VERSION`.
